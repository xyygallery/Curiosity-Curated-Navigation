<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>HTML 代码生成器（问卷式）</title>

<style>
body {
  font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
  background: #fafafa;
  color: #333;
  max-width: 720px;
  margin: 40px auto;
  padding: 20px;
}

h1 {
  font-weight: 500;
}

.step {
  display: none;
  margin-top: 30px;
}

.step.active {
  display: block;
}

label {
  font-size: 14px;
  color: #555;
}

input {
  width: 100%;
  padding: 10px 12px;
  margin-top: 8px;
  border: 1px solid #ddd;
  border-radius: 6px;
  font-size: 14px;
}

input:focus {
  outline: none;
  border-color: #0070f3;
  box-shadow: 0 0 0 3px rgba(0,118,255,.1);
}

button {
  background: #0070f3;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 10px 18px;
  font-size: 14px;
  margin-top: 18px;
  cursor: pointer;
}

button:hover {
  background: #0059c9;
}

.msg {
  font-size: 13px;
  color: #e00;
  margin-top: 8px;
  display: none;
}

pre {
  background: #fff;
  border: 1px solid #eee;
  padding: 15px;
  border-radius: 8px;
  margin-top: 20px;
  font-size: 13px;
  overflow-x: auto;
}
</style>
</head>

<body>

<h1>HTML 代码生成器（问卷模式）</h1>

<!-- Step 1 -->
<div class="step active" data-step="0">
  <label>标题（最多 7 个中文）</label>
  <input id="title" placeholder="例如：98.js">
  <div class="msg" id="titleMsg">⚠️ 标题最多 7 个中文</div>
  <button onclick="nextStep()">下一步</button>
</div>

<!-- Step 2 -->
<div class="step" data-step="1">
  <label>描述（最多 11 个中文）</label>
  <input id="desc" placeholder="例如：Windows 98 模拟">
  <div class="msg" id="descMsg">⚠️ 描述最多 11 个中文</div>
  <button onclick="nextStep()">下一步</button>
</div>

<!-- Step 3 -->
<div class="step" data-step="2">
  <label>URL</label>
  <input id="url" placeholder="https://example.com">
  <div class="msg" id="urlMsg">❌ URL 必须以 http:// 或 https:// 开头</div>
  <button onclick="nextStep()">下一步</button>
</div>

<!-- Step 4 -->
<div class="step" data-step="3">
  <label>收录日期</label>
  <input type="date" id="date">
  <button onclick="generate()">生成代码</button>
</div>

<!-- Result -->
<div class="step" data-step="4">
  <h2>生成结果</h2>
  <pre id="output"></pre>
</div>

<script>
let currentStep = 0;
const steps = document.querySelectorAll('.step');

function showStep(index) {
  steps.forEach((s, i) => {
    s.classList.toggle('active', i === index);
  });
}

function limitChinese(input, limit, msgEl) {
  input.addEventListener('input', () => {
    const chars = input.value.match(/[\u4e00-\u9fa5]/g) || [];
    if (chars.length > limit) {
      input.value = input.value.slice(0, -1);
      msgEl.style.display = 'block';
      setTimeout(() => msgEl.style.display = 'none', 2000);
    }
  });
}

limitChinese(title, 7, titleMsg);
limitChinese(desc, 11, descMsg);

function nextStep() {
  if (currentStep === 0 && !title.value.trim()) return;
  if (currentStep === 1 && !desc.value.trim()) return;

  if (currentStep === 2) {
    if (!/^https?:\/\//.test(url.value.trim())) {
      urlMsg.style.display = 'block';
      setTimeout(() => urlMsg.style.display = 'none', 2000);
      return;
    }
  }

  currentStep++;
  showStep(currentStep);
}

function getTodayISO() {
  const d = new Date();
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}

date.value = getTodayISO();

function formatDateDisplay(dateStr) {
  const [y,m,d] = dateStr.split("-");
  return `${parseInt(y)}/${parseInt(m)}/${parseInt(d)}`;
}

function generate() {
  const dateText = formatDateDisplay(date.value);

  const code = `
<a href="${url.value}" target="_blank" title="收录日期：${dateText}">
  <h2>${title.value} -></h2>
  <p>${desc.value}</p>
</a>
`.trim();

  output.textContent = code;
  currentStep = 4;
  showStep(currentStep);
}
</script>

</body>
</html>
