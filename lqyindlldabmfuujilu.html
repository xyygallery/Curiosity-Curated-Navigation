<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>宝宝记录（iOS 优化版）</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
    --pink: #ff7fbf;
    --pink-light: #ffe8f3;
    --text-dark: #444;
}
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    background: #fff0f7;
    margin: 0;
    padding: 15px;
}
.section {
    background: white;
    padding: 20px;
    margin-bottom: 16px;
    border-radius: 16px;
    box-shadow: 0 3px 8px rgba(255,140,180,0.3);
}
h2 {
    margin: 0 0 12px;
    font-size: 20px;
    color: var(--pink);
    font-weight: bold;
}
input, select, button {
    width: 100%;
    padding: 16px;
    font-size: 18px;
    border-radius: 12px;
    margin: 8px 0;
    border: 2px solid #ffd1e8;
    background: #fffafd;
    box-sizing: border-box;
}
button {
    background: var(--pink);
    color: white;
    border: none;
    font-size: 20px;
    font-weight: bold;
}
button:active { opacity: .8; }
.item {
    padding: 10px 0;
    border-bottom: 1px solid #ffd8eb;
    font-size: 16px;
    color: var(--text-dark);
}
.stats {
    font-size: 16px;
    margin-top: 10px;
    line-height: 1.6;
}
.bold { font-weight: bold; }
</style>
</head>
<body>

<h2>宝宝记录（iOS 优化版）</h2>

<!-- 奶量 -->
<div class="section">
<h2>喝奶记录</h2>
<input id="milkMix" type="number" placeholder="冲调奶量（ml）">
<input id="milkLeft" type="number" placeholder="剩余奶量（ml）">
<button id="milkBtn">记录奶量</button>

<div class="stats">
今日喝奶：<span id="milkToday">0</span> ml<br>
今日浪费：<span id="wasteToday">0</span> ml<br>
累计喝奶：<span id="milkTotal">0</span> ml<br>
累计浪费：<span id="wasteTotal">0</span> ml<br>
上次间隔：<span id="milkGap">无</span>
</div>
<div id="milkList"></div>
</div>

<!-- 大便 -->
<div class="section">
<h2>大便记录</h2>
<select id="pooStatus">
  <option value="正常">正常</option>
  <option value="稀">稀</option>
  <option value="干">干</option>
  <option value="其他">其他</option>
</select>
<input id="pooNote" placeholder="备注（可空）">
<button id="pooBtn">记录大便</button>

<div class="stats">
今日次数：<span id="pooToday">0</span>
</div>
<div id="pooList"></div>
</div>

<!-- 辅食 -->
<div class="section">
<h2>辅食记录</h2>
<input id="foodInput" placeholder="辅食内容（如 南瓜泥）">
<button id="foodBtn">记录辅食</button>

<div class="stats">
今日辅食次数：<span id="foodToday">0</span>
</div>
<div id="foodList"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {

    // 数据初始化
    let milk = JSON.parse(localStorage.getItem("milk") || "[]");
    let poo  = JSON.parse(localStorage.getItem("poo") || "[]");
    let food = JSON.parse(localStorage.getItem("food") || "[]");

    function save() {
        localStorage.setItem("milk", JSON.stringify(milk));
        localStorage.setItem("poo", JSON.stringify(poo));
        localStorage.setItem("food", JSON.stringify(food));
    }

    function now() { return new Date().toISOString().slice(0,16).replace("T"," "); }

    // 奶量记录
    function addMilk() {
        const mixEl = document.getElementById("milkMix");
        const leftEl = document.getElementById("milkLeft");
        const mix = parseInt(mixEl.value);
        const left = parseInt(leftEl.value);
        if (!mix && mix!==0) { alert("请输入冲调奶量"); return; }
        if (left<0 || left>mix) { alert("剩余奶量不合理"); return; }
        const drink = mix - left;
        const waste = left;
        milk.push({mix, left, drink, waste, time: now()});
        save(); updateMilk();
        mixEl.value=""; leftEl.value="";
    }

    function updateMilk() {
        const milkList = document.getElementById("milkList");
        milkList.innerHTML = milk.map(i =>
            `<div class="item">${i.time}<br>冲调 <b>${i.mix}</b> ml · 喝掉 <b>${i.drink}</b> ml · 浪费 <b>${i.waste}</b> ml</div>`
        ).join("");
        const today = new Date().toISOString().slice(0,10);
        document.getElementById("milkToday").textContent = milk.filter(i=>i.time.startsWith(today)).reduce((a,b)=>a+b.drink,0);
        document.getElementById("wasteToday").textContent = milk.filter(i=>i.time.startsWith(today)).reduce((a,b)=>a+b.waste,0);
        document.getElementById("milkTotal").textContent = milk.reduce((a,b)=>a+b.drink,0);
        document.getElementById("wasteTotal").textContent = milk.reduce((a,b)=>a+b.waste,0);
        const gapEl = document.getElementById("milkGap");
        if (milk.length<2){ gapEl.textContent="无"; return; }
        const t1 = new Date(milk[milk.length-1].time);
        const t2 = new Date(milk[milk.length-2].time);
        gapEl.textContent = Math.floor((t1-t2)/60000) + " 分钟";
    }

    // 大便记录
    function addPoo() {
        const statusEl = document.getElementById("pooStatus");
        const noteEl = document.getElementById("pooNote");
        const status = statusEl.value;
        const note = noteEl.value.trim();
        poo.push({status, note, time: now()});
        save(); updatePoo();
        noteEl.value="";
    }

    function updatePoo() {
        const pooList = document.getElementById("pooList");
        pooList.innerHTML = poo.map(i =>
            `<div class="item">${i.time} - <b>${i.status}</b> ${i.note||""}</div>`
        ).join("");
        const today = new Date().toISOString().slice(0,10);
        document.getElementById("pooToday").textContent = poo.filter(i=>i.time.startsWith(today)).length;
    }

    // 辅食记录
    function addFood() {
        const foodEl = document.getElementById("foodInput");
        const t = foodEl.value.trim();
        if (!t){ alert("请输入辅食内容"); return; }
        food.push({text:t, time: now()});
        save(); updateFood();
        foodEl.value="";
    }

    function updateFood() {
        const foodList = document.getElementById("foodList");
        foodList.innerHTML = food.map(i =>
            `<div class="item">${i.time} - <b>${i.text}</b></div>`
        ).join("");
        const today = new Date().toISOString().slice(0,10);
        document.getElementById("foodToday").textContent = food.filter(i=>i.time.startsWith(today)).length;
    }

    // 按钮绑定
    document.getElementById("milkBtn").addEventListener("click", addMilk);
    document.getElementById("pooBtn").addEventListener("click", addPoo);
    document.getElementById("foodBtn").addEventListener("click", addFood);

    // 初始加载
    updateMilk();
    updatePoo();
    updateFood();

});
</script>
</body>
</html>
